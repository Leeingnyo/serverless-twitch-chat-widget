<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="./viewer.css" type="text/css">
</head>
<body>

<div id="wrapper">
</div>

<script src="./onerror.js"></script>
<script src="./secret.js"></script>
<script src="./config.js"></script>
<script src="./viewer-config.js"></script>
<script src="./irc.js"></script>
<script src="./twitch-irc.js"></script>
<script src="./client.js"></script>
<script src="./dom.js"></script>
<script src="./image-json.js"></script>
<script src="./viewer-option.js"></script>
<script src="./viewer.js"></script>
<script id="register handlers">
const client = new TwitchIrcClient(configs);
client.run();

const wrapper = document.querySelector('#wrapper');
const templateBuilder = new TemplateBuilder(options, imageLinkMap);
const chatList = new ChatList(templateBuilder, configs);
chatList.mount(wrapper);

// echo
client.registerHandler({
  handle: (message) => {
    if (message.command !== 'PRIVMSG') return;
    chatList.addMessage(message);
    // FIXME not good
  }
});

// data: { chats: [] }
// modifier: { addMessage, removeMessage }
// notify changes after modifying
// add listener that makes viewer update its dom with whole data
// caching chat doms by the id of chat
// viewer uses modifier
// 귀찮음
</script>

</body>